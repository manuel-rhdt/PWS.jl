<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Guide · PWS.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PWS.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Background</a></li><li class="is-active"><a class="tocitem" href>Guide</a><ul class="internal"><li><a class="tocitem" href="#Setting-Up-the-System"><span>Setting Up the System</span></a></li><li><a class="tocitem" href="#Generating-and-Plotting-Trajectories"><span>Generating and Plotting Trajectories</span></a></li><li><a class="tocitem" href="#Computing-the-Trajectory-Mutual-Information"><span>Computing the Trajectory Mutual Information</span></a></li><li><a class="tocitem" href="#Using-More-Advanced-Marginalization-Strategies"><span>Using More Advanced Marginalization Strategies</span></a></li><li><a class="tocitem" href="#API-Summary"><span>API Summary</span></a></li></ul></li><li><a class="tocitem" href="../thermodynamic_integration/">Thermodynamic Integral</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Guide</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/manuel-rhdt/PWS.jl/blob/master/docs/src/guide.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Guide"><a class="docs-heading-anchor" href="#Guide">Guide</a><a id="Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Guide" title="Permalink"></a></h1><p>In this section we will show step by step how PWS.jl can be used to compute the mutual information for a simple model of gene expression.</p><h2 id="Setting-Up-the-System"><a class="docs-heading-anchor" href="#Setting-Up-the-System">Setting Up the System</a><a id="Setting-Up-the-System-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-Up-the-System" title="Permalink"></a></h2><p>The model considered in this example consists of four reactions:</p><pre><code class="nohighlight hljs">                κ
reaction 1:  ∅ ---&gt; S

                λ
reaction 2:  S ---&gt; ∅

                ρ
reaction 3:  S ---&gt; S + X

                μ
reaction 4:  X ---&gt; ∅</code></pre><p>The first two reactions specify the evolution of the input signal <code>S</code>, and last two reactions specify the evolution of the output <code>X</code>. Thus, both the input and output signal are modeled as a simple birth-death process, however the birth rate of <code>X</code> increases with higher copy numbers of  <code>S</code>.</p><p>The first step is to create the system that we are going to use. The simple gene expression model shown above is already included as an example in PWS.jl and can be directly used as follows:</p><pre><code class="language-julia hljs">using PWS

system = PWS.gene_expression_system()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SimpleSystem with input variables: S(t)
                 output variables: X(t)
Initial condition:
    S(t) = 50
    X(t) = 50
Parameters:
    κ = 50.0
    λ = 1.0
    ρ = 10.0
    μ = 10.0</code></pre><p>The result is a <code>system</code> consisting of the 4 reactions mentioned above and default values for the initial condition and the parameters that specify the reaction rates.</p><h2 id="Generating-and-Plotting-Trajectories"><a class="docs-heading-anchor" href="#Generating-and-Plotting-Trajectories">Generating and Plotting Trajectories</a><a id="Generating-and-Plotting-Trajectories-1"></a><a class="docs-heading-anchor-permalink" href="#Generating-and-Plotting-Trajectories" title="Permalink"></a></h2><p>We can generate a <em>configuration</em> of this system. A configuration is a combination of an input trajectory and an output trajectories. Using <code>generate_configuration</code> we can create a configuration by first simulating an input trajectory and then use that input trajectory to simulate a corresponding output trajectory.</p><pre><code class="language-julia hljs">conf = generate_configuration(system)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PWS.SXconfiguration{StaticArrays.SVector{1, Int64}, StaticArrays.SVector{1, Int64}, Float64}(PWS.Trajectory{StaticArrays.SVector{1, Int64}, Float64}(StaticArrays.SVector{1, Int64}[[50], [51], [52], [51], [52], [53], [52], [53], [52], [53]  …  [56], [57], [58], [57], [56], [55], [56], [55], [56], [57]], [0.004037698343863122, 0.013595804858402973, 0.015487474178918218, 0.02619969839422067, 0.029326910920732266, 0.04098693816071055, 0.04553594109632973, 0.04666135410197454, 0.05954907099110811, 0.05959938630432349  …  1.9165891425959949, 1.9405636566039, 1.9434411324920111, 1.9457057547968701, 1.9663606495909267, 1.9864101937635807, 1.988203546433829, 1.9978279505527134, 1.9987516454916154, 2.0], [1, 1, 2, 1, 1, 2, 1, 2, 1, 1  …  1, 1, 2, 2, 2, 1, 2, 1, 1, 0]), PWS.Trajectory{StaticArrays.SVector{1, Int64}, Float64}(StaticArrays.SVector{1, Int64}[[50], [49], [48], [49], [48], [49], [50], [49], [50], [51]  …  [56], [55], [56], [57], [56], [57], [58], [57], [58], [57]], [0.00045687094450343055, 0.0008060868547120899, 0.001814783990718737, 0.0023938354246031694, 0.004091054182851959, 0.005745330761215933, 0.009462737768644192, 0.011287511997471907, 0.01207157961112049, 0.0124696714167843  …  1.9910210421287575, 1.9923577050781904, 1.9923910023752542, 1.9942603232369598, 1.9949325293383546, 1.9959010527516243, 1.996363327549447, 1.9984889585229884, 1.999075347112564, 2.0], [4, 4, 3, 4, 3, 3, 4, 3, 3, 4  …  4, 3, 3, 4, 3, 3, 4, 3, 4, 0]))</code></pre><p>Let us plot the generated configuration:</p><pre><code class="language-julia hljs">using Plots
plot(conf)</code></pre><p><img src="../plot1.svg" alt/></p><p>We see a plot of the generated input and output trajectories that make up the configuration.</p><p>The individual trajectories of the configuration can also be accessed directly:</p><pre><code class="language-julia hljs">input_traj = conf.s_traj
output_traj = conf.x_traj
p1 = plot(input_traj, label=&quot;input&quot;)
p2 = plot(output_traj, label=&quot;output&quot;)
plot(p1, p2, layout = (2, 1))</code></pre><p><img src="../plot2.svg" alt/></p><h2 id="Computing-the-Trajectory-Mutual-Information"><a class="docs-heading-anchor" href="#Computing-the-Trajectory-Mutual-Information">Computing the Trajectory Mutual Information</a><a id="Computing-the-Trajectory-Mutual-Information-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-the-Trajectory-Mutual-Information" title="Permalink"></a></h2><p>For our system we can compute the trajectory mutual information straightforwardly. </p><pre><code class="language-julia hljs">result = PWS.mutual_information(system, DirectMCEstimate(256), num_samples=100)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Progress:   2%|▌                          |  ETA: 0:08:43 ( 5.33  s/it)Progress:  23%|██████▎                    |  ETA: 0:00:46 ( 0.60  s/it)Progress:  37%|██████████                 |  ETA: 0:00:26 ( 0.41  s/it)Progress:  51%|█████████████▊             |  ETA: 0:00:16 ( 0.33  s/it)Progress:  64%|█████████████████▎         |  ETA: 0:00:10 ( 0.28  s/it)Progress:  77%|████████████████████▊      |  ETA: 0:00:06 ( 0.25  s/it)Progress:  90%|████████████████████████▎  |  ETA: 0:00:02 ( 0.23  s/it)Progress: 100%|███████████████████████████| Time: 0:00:21 ( 0.22  s/it)</code></pre><p>This performs a full PWS Monte Carlo simulation and displays a progress bar during the computation. Naturally, the <code>PWS.mutual_information</code> takes the <code>system</code> as its first argument. The second argument is an object specifying the <em>marginalization</em> algorithm to use for computing the marginal trajectory probability. Here we chose the simple brute-force <code>DirectMC</code> algorithm with <span>$M=256$</span> samples. Thus, we compute a &quot;Direct PWS&quot; estimate. The final keyword argument is the overall number of Monte Carlo samples to use for estimating the mutual information. This is the number of samples taken in the <em>outer</em> Monte Carlo simulation as opposed to the <span>$M=256$</span> samples taken in the <em>inner</em> Monte Carlo loop.</p><p><code>result</code> is a <code>DataFrame</code> containing the simulation results. We can display the individual Monte Carlo samples:</p><pre><code class="language-julia hljs">plot(
    system.dtimes,
    result.MutualInformation,
    color=:black,
    linewidth=0.2,
    legend=false,
    xlabel=&quot;trajectory duration&quot;,
    ylabel=&quot;mutual information (nats)&quot;
)</code></pre><p><img src="../plot3.svg" alt/></p><p>The final Monte Carlo estimate is simply the <code>mean</code> of the individual samples:</p><pre><code class="language-julia hljs">using Statistics
plot(
    system.dtimes,
    mean(result.MutualInformation),
    color=:black,
    linewidth=2,
    legend=false,
    xlabel=&quot;trajectory duration&quot;,
    ylabel=&quot;mutual information (nats)&quot;
)</code></pre><p><img src="../plot4.svg" alt/></p><p>Note that since we only used 100 MC samples the fluctuation of the result is relatively large. To judge the statistical error due to the number of Monte Carlo samples, we can additionally plot error bars. A common error measure in Monte Carlo simulations is the &quot;standard error of the mean&quot;, defined as the standard deviation divided by the square root of the number of samples. We use this method to draw error bars.</p><pre><code class="language-julia hljs">sem(x) = std(x) / sqrt(length(x))
plot(
    system.dtimes,
    mean(result.MutualInformation),
    yerr=sem(result.MutualInformation),
    color=:black,
    linewidth=2,
    legend=false,
    xlabel=&quot;trajectory duration&quot;,
    ylabel=&quot;mutual information (nats)&quot;
)</code></pre><p><img src="../plot5.svg" alt/></p><h2 id="Using-More-Advanced-Marginalization-Strategies"><a class="docs-heading-anchor" href="#Using-More-Advanced-Marginalization-Strategies">Using More Advanced Marginalization Strategies</a><a id="Using-More-Advanced-Marginalization-Strategies-1"></a><a class="docs-heading-anchor-permalink" href="#Using-More-Advanced-Marginalization-Strategies" title="Permalink"></a></h2><p>So far we computed the mutual information using the brute-force <em>Direct PWS</em> algorithm. However, we can choose a different approach to perform the marginalization integrals.</p><h2 id="API-Summary"><a class="docs-heading-anchor" href="#API-Summary">API Summary</a><a id="API-Summary-1"></a><a class="docs-heading-anchor-permalink" href="#API-Summary" title="Permalink"></a></h2><p>Thus, the core function to estimate the trajectory mutual information is <code>PWS.mutual_information</code>. A complete description of its arguments and return value is given below.</p><article class="docstring"><header><a class="docstring-binding" id="PWS.mutual_information" href="#PWS.mutual_information"><code>PWS.mutual_information</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mutual_information(system, algorithm; num_samples=1, progress=true)</code></pre><p>Perform a simulation to compute the mutual information between input and output trajectories of <code>system</code>. </p><p><strong>Arguments</strong></p><p>The required marginalization integrals to obtain the marginal probability <span>$\mathcal{P}[\bm{x}]$</span> are performed using the specified <code>algorithm</code>.</p><p>Overall, <code>num_samples</code> Monte Carlo samples are performed. For each individual sample, one or mupltiple marginalization operations need to be performed.</p><p>If <code>progress == true</code>, a progress bar will be shown during the computation.</p><p><strong>Returns</strong></p><p>Returns a <code>DataFrame</code> containing the results of the simulation. This resulting <code>DataFrame</code> has 3 columns. Assuming, the returned value has been named <code>result</code> the columns can be accessed by:</p><ul><li><code>result.MutualInformation</code>: A vector of vectors that contains the results of the simulation. Each element of the outer vector is the result of a single Monte Carlo sample. Each element is a vector containing the trajectory mutual information estimates for each time specified in <code>system.dtimes</code>.</li><li><code>result.TimeMarginal</code>: A vector containing, for each sample, the CPU time in seconds used for the computation of the marginal entropy.</li><li><code>result.TimeConditional</code>: A vector containing, for each sample, the CPU time in seconds used for the computation of the conditional entropy.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/manuel-rhdt/PWS.jl/blob/f803b573ebc45c42875de7888563200b837230f7/src/marginal_strategies/strategies.jl#L23-L49">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Background</a><a class="docs-footer-nextpage" href="../thermodynamic_integration/">Thermodynamic Integral »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.8 on <span class="colophon-date" title="Tuesday 9 November 2021 15:07">Tuesday 9 November 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

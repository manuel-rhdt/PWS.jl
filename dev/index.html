<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PathWeightSampling.jl · PathWeightSampling.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>PathWeightSampling.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>PathWeightSampling.jl</a><ul class="internal"><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Quick-Start"><span>Quick Start</span></a></li><li><a class="tocitem" href="#Acknowledgments"><span>Acknowledgments</span></a></li></ul></li><li><a class="tocitem" href="guide/">Guide</a></li><li><a class="tocitem" href="systems/">Systems</a></li><li><a class="tocitem" href="examples/">Examples</a></li><li><a class="tocitem" href="marginalization/">Marginalization Strategies</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>PathWeightSampling.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>PathWeightSampling.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/manuel-rhdt/PathWeightSampling.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PathWeightSampling.jl"><a class="docs-heading-anchor" href="#PathWeightSampling.jl">PathWeightSampling.jl</a><a id="PathWeightSampling.jl-1"></a><a class="docs-heading-anchor-permalink" href="#PathWeightSampling.jl" title="Permalink"></a></h1><p>PathWeightSampling.jl is a Julia package to compute information transmission rates using the Path Weight Sampling (PWS) method.</p><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>Information is a fundamental resource in complex systems at all scales, from bacterial signaling networks to artificial neural networks.  These systems receive input signals which are analyzed, filtered, transcoded, or otherwise transformed to yield an output signal. The generic mathematical framework to study the flow of information in these systems is <em>information theory</em> which defines a central quantity to quantify the amount of information that the output contains about the input: the <em>mutual information</em>. Specifically, this measure quantifies the number of distinct mappings between input and output that can be distinguished uniquely and is thus a measure of the fidelity of the input-output relationship.</p><p>Mathematically, the mutual information between two random variables, <span>$S$</span> and <span>$X$</span> is defined as</p><p class="math-container">\[\mathrm{I}(S, X) = \sum_{s\in S, x\in X} \mathrm{P}(s, x) \ln\frac{\mathrm{P}(s, x)}{\mathrm{P}(s) \mathrm{P}(x)} \,.\]</p><p>However, the mutual information between scalar random variables <span>$S$</span> and <span>$X$</span> does not quantify the <em>rate</em> of information transmission. Indeed, most systems receive time-dependent input signals, i.e. a sequence of messages over time, which are transformed into a time-dependent output signal.  In most systems a given input message is not independent from previous input messages. These autocorrelations within the input reduce the rate at which information is received. Additionally, correlations within the output signal can also reduce the information transmission rate. Hence, to quantify the rate of information transmission, the instantaneous mutual information between scalar random variables <span>$S$</span> and <span>$X$</span> is not sufficient, and we require a better mutual information measure.</p><p>The solution to this problem is to compute the mutual information between entire trajectories of input and output, not between input and output values at given time points. In this way, correlations within the input and the output are taken into account when computing the mutual information. The mathematical form of the trajectory mutual information is analogous to the scalar case:</p><p class="math-container">\[\mathrm{I}(\bm{S}, \bm{X}) = \sum_{\bm{s}\in \bm{S}, \bm{x}\in \bm{X}} \mathrm{P}(\bm{s}, \bm{x}) \ln\frac{\mathrm{P}(\bm{s}, \bm{x})}{\mathrm{P}(\bm{s}) \mathrm{P}(\bm{x})}\]</p><p>but now the sum runs over all possible input and output trajectories (which are denoted using bold symbols), not unlike a path integral.  The information transmission rate <span>$\mathrm{R}(\bm{S}, \bm{X})$</span> is then defined as the asymptotic rate at which the trajectory mutual information increases with the duration of the input and output trajectories, i.e.</p><p class="math-container">\[\mathrm{R}(\bm{S}, \bm{X}) = \lim_{T\rightarrow\infty} \frac{\mathrm{d}\mathrm{I}(\bm{S}_T, \bm{X}_T)}{\mathrm{d}T}\]</p><p>where <span>$\bm{S}_T$</span> and <span>$\bm{X}_T$</span> are trajectory-valued random variables of trajectories with duration <span>$T$</span>.</p><p>PWS is a novel method to compute the mutual information between input and output trajectories for systems described by a master equation. </p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>From the Julia REPL, type</p><pre><code class="nohighlight hljs">julia&gt; import Pkg; Pkg.add(&quot;PathWeightSampling&quot;)</code></pre><p>Alternatively, you can install this package by starting Julia, typing <code>]</code> and then</p><pre><code class="nohighlight hljs">pkg&gt; add PathWeightSampling</code></pre><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><p>After installation, the package can be loaded from directly from julia.</p><pre><code class="language-julia hljs">julia&gt; using PathWeightSampling</code></pre><p>We then need a <em>system</em> of reactions for which we want to compute the mutual information. We can use one of the included example systems, such as a simple model for gene expression.</p><pre><code class="language-julia hljs">julia&gt; system = PathWeightSampling.gene_expression_system()
SimpleSystem with 4 reactions
Input variables: S(t)
Output variables: X(t)
Initial condition:
    S(t) = 50
    X(t) = 50
Parameters:
    κ = 50.0
    λ = 1.0
    ρ = 10.0
    μ = 10.0</code></pre><p>This specific model is very simple, consisting of only 4 reactions:</p><ul><li>∅ → S with rate <em>κ</em></li><li>S → ∅ with rate <em>λ</em></li><li>S → S + X with rate <em>ρ</em></li><li>X → ∅ with rate <em>μ</em></li></ul><p>S represents the input and X represents the output. The values of the parameters can be inspected from the output above. For this system, we can perform a PWS simulation to compute the mutual information between its input and output trajectories:</p><pre><code class="language-julia hljs">julia&gt; result = mutual_information(system, DirectMCEstimate(256), num_samples=1000)</code></pre><p>Here we just made a default choice for which marginalization algorithm to use. This computation takes approximately a minute on a typical laptop. The result  is a <code>DataFrame</code> with three columns and 1000 rows:</p><pre><code class="language-julia hljs">1000×3 DataFrame
  Row │ TimeConditional  TimeMarginal  MutualInformation                 
      │ Float64          Float64       Vector{Float64}                   
──────┼──────────────────────────────────────────────────────────────────
    1 │     0.000180898     0.0508378  [0.0, -0.67167, 0.388398, -0.343…
  ⋮   │        ⋮              ⋮                        ⋮
 1000 │     0.00020897      0.0694072  [0.0, 0.254173, 0.362607, 0.2584…
                                                         998 rows omitted</code></pre><p>Each row represents one Monte Carlo sample.</p><ul><li><code>TimeConditional</code> is the CPU time in seconds for the computation of the conditional probability P(<strong>x</strong>|<strong>s</strong>)</li><li><code>TimeMarginal</code> is the CPU time in seconds for the computation of the marginal probability P(<strong>x</strong>|<strong>s</strong>)</li><li><code>MutualInformation</code> is the resulting mutual information estimate. This is a vector for each sample giving the mutual information for trajectories of different durations. The durations to which these individual values correspond is given by</li></ul><pre><code class="language-julia hljs">julia&gt; system.dtimes
0.0:0.1:2.0</code></pre><p>So we computed the mutual information for trajectories of duration <code>0.0, 0.1, 0.2, ..., 2.0</code>.</p><p>We can plot the results (assuming the package Plots.jl is installed):</p><pre><code class="language-julia hljs">julia&gt; using Plots, Statistics
julia&gt; plot(
           system.dtimes,
           mean(result.MutualInformation),
           legend=false,
           xlabel=&quot;trajectory duration&quot;,
           ylabel=&quot;mutual information (nats)&quot;
       )</code></pre><p><img src="assets/example_plot.svg" alt="Plot of the mutual information as a function of trajectory duration for the simple gene expression system."/></p><p>Here we plot <code>mean(result.MutualInformation)</code>, i.e. we compute the average of our Monte Carlo samples, which is the PWS estimate for the mutual information.</p><h2 id="Acknowledgments"><a class="docs-heading-anchor" href="#Acknowledgments">Acknowledgments</a><a id="Acknowledgments-1"></a><a class="docs-heading-anchor-permalink" href="#Acknowledgments" title="Permalink"></a></h2><p>This work was performed at the research institute <a href="https://amolf.nl">AMOLF</a>. This project has received funding from the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation program (grant agreement No. 885065) and was financially supported by the Dutch Research Council (NWO) through the “Building a Synthetic Cell (BaSyC)” Gravitation grant (024.003.019).</p><p><a href="https://www.nwo.nl"><img src="assets/logo-nwo.svg" alt="Logo NWO"/></a> <a href="https://amolf.nl"><img src="assets/logo-amolf.svg" alt="Logo AMOLF"/></a> <a href="https://www.basyc.nl"><img src="assets/logo-basyc.png" alt="Logo BaSyC"/></a></p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="guide/">Guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.8 on <span class="colophon-date" title="Tuesday 10 May 2022 12:59">Tuesday 10 May 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
